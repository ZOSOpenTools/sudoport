export ZOPEN_GIT_URL="https://github.com/sudo-project/sudo.git"
export ZOPEN_GIT_DEPS="make coreutils zoslib openssl zlib"
SUDO_VERSION="1.9.13p3"
export ZOPEN_TARBALL_URL="https://www.sudo.ws/dist/sudo-$SUDO_VERSION.tar.gz"
export ZOPEN_TARBALL_DEPS="make coreutils zoslib openssl zlib"
#TODO: add zlib, openssl
export ZOPEN_EXTRA_CONFIGURE_OPTS="--without-interfaces --with-runas-default=BPXROOT"
export ZOPEN_TYPE="TARBALL"
export ZOPEN_MAKE_MINIMAL="yes"
export ZOPEN_MAKE_OPTS="-j\$ZOPEN_NUM_JOBS"
export ZOPEN_CHECK_MINIMAL="yes"
export ZOPEN_CHECK_OPTS="-i check-verbose"
export ZOPEN_INSTALL_OPTS="install vardir=\"\$ZOPEN_INSTALL_DIR/var/lib/sudo\" sysconfdir=\"\$ZOPEN_INSTALL_DIR/etc\" rundir=\"\$ZOPEN_INSTALL_DIR/var/run/sudo\""
export ZOPEN_COMP=CLANG # use clang

zopen_check_results()
{
# Expected success rate should be 91.19%
chk="$1/$2_check.log"

successes=$(grep -e ".*: OK" ${chk} | wc -l)
failures=$(grep -e ".*: FAIL" ${chk} | wc -l)
totalRunTests=$(($successes+$failures))

cat <<ZZ
actualFailures:$failures
totalTests:$totalRunTests
expectedFailures:23
ZZ
}

zopen_append_to_env()
{
  # echo envars outside of PATH, MANPATH, LIBPATH
}

zopen_append_to_setup()
{
cat <<EOF
 if [ "\$(id -u)" -eq 0 ]; then
    echo "Adding sticky bit to binaries"
    chown 0:0 \$SUDO_HOME/*bin/*
    chmod u+s \$SUDO_HOME/*bin/*
    echo "An example sudoers is provided in \$SUDO_HOME/etc/sudoers"
 else
    echo "You must run the setup.sh script as root. Exiting"
 fi 
EOF
}

zopen_get_version()
{
  echo "$SUDO_VERSION"
}
